{% extends "base.html" %}
{% block content %}
<h2>ğŸ”— AI Combo: Summary â†’ Sentiment</h2>

<form method="post" onsubmit="startLoading(this)">
  {% csrf_token %}
  {{ form.as_p }}

  <button type="submit" id = "submit-btn">ì‹¤í–‰</button>
  <div id="loading" style="display:none;">
            <h5>ë¡œë”©ì¤‘.. ì ì‹œë§Œ ê¸°ë‹¤ë ¤ì£¼ì„¸ìš”</h5>
            </div>
  {% if result %}
    <button type="submit" id = "submit-btn">ì¬ìƒì„±</button>
    <div id="loading" style="display:none;">
            <h5>ë¡œë”©ì¤‘.. ì ì‹œë§Œ ê¸°ë‹¤ë ¤ì£¼ì„¸ìš”</h5>
            </div>
  {% endif %}
</form>

{% if result %}
  <h3>ìµœì¢… ê²°ê³¼</h3>
  <pre>{{ result }}</pre>
{% endif %}


  {% if history %}
    {% for item in history|slice:":5" %}
        <div class="history-item">
            <strong>ì…ë ¥ í…ìŠ¤íŠ¸:</strong>
            {{ item.user_input|truncatewords:8 }}<br>

            <strong>ê²°ê³¼:</strong><br>
            <div class="combo-result">
                {{ item.model_output|truncatewords:30 }}
            </div>

            <small class="text-muted">
                {{ item.created_at }}
            </small>
        </div>
    {% endfor %}
{% else %}
    <p class="text-muted">íˆìŠ¤í† ë¦¬ê°€ ì—†ìŠµë‹ˆë‹¤.</p>
{% endif %}

{% endblock %}
{%block extra_js%}
<script>
function startLoading(form) {
    document.getElementById("loading").style.display = "block";
    document.getElementById("submit-btn").disabled = true;
}
</script>
{%endblock%}
